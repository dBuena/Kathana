<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Item Page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-3">

  <p>
    This is a test item 
    <a href="#" class="item-link" data-item-id="4001">Item#5</a>
  </p>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.querySelectorAll(".item-link").forEach(link => {
      const itemId = link.dataset.itemId;

      // Initialize tooltip with placeholder
      const tooltip = new bootstrap.Tooltip(link, {
        title: "Loading...",
        html: true,
        trigger: "hover"
      });

      // Fetch tooltip content dynamically on hover
      link.addEventListener("mouseenter", async () => {
        if (link.dataset.loaded) return; // only load once

        const response = await fetch("items.json");
        const items = await response.json();
        const item = items.find(i => i.ID == itemId);

        if (item) {
          tooltip.setContent({
            '.tooltip-inner': `
              <h5>${item.ItemName}</h5>
              <p>${item.Description}</p>
              <p><strong>Attack:</strong> ${item.iEffect1Param1}-${item.iEffect1Param2}</p>
              <p><strong>Class:</strong> ${item.ClassLimit}</p>
              <p><strong>Price:</strong> ${item.ShopPrice} / Sell: ${item.SellPrice}</p>
              <p><strong>Durability:</strong> ${item.MaxDurability}</p>
            `
          });
          link.dataset.loaded = "true";
        } else {
          tooltip.setContent({'.tooltip-inner': "Item not found"});
        }
      });
    });
  </script>
</body>
</html>
